{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-clipboard-list"></i> Lista de Pedidos</h2>
    <a href="{% url 'agregar_pedido' %}" class="btn btn-primary">
        <i class="fas fa-cart-plus"></i> Realizar Pedido
    </a>
</div>

{% if pedidos %}
<div class="table-responsive">
    <table class="table table-striped table-hover shadow-sm">
        <thead class="bg-dark text-white">
            <tr>
                <th>ID Pedido</th>
                <th>Fecha Pedido</th>
                <th>Estado</th>
                <th>Total</th>
                <th>Fecha Entrega</th>
                <th>Productos</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for pedido in pedidos %}
            <tr>
                <td>{{ pedido.pk }}</td>
                <td>{{ pedido.fecha }}</td>
                <td>
                    <span class="badge
                        {% if pedido.estado == 'Pendiente' %}bg-warning text-dark
                        {% elif pedido.estado == 'En Proceso' %}bg-info
                        {% elif pedido.estado == 'Completado' %}bg-success
                        {% elif pedido.estado == 'Cancelado' %}bg-danger
                        {% else %}bg-secondary{% endif %}">
                        {{ pedido.estado }}
                    </span>
                </td>
                <td>${{ pedido.total|floatformat:2 }}</td>
                <td>{{ pedido.fecha_entrega|default:"N/A" }}</td>
                <td>
                    {% for producto in pedido.productos.all %}
                        <span class="badge bg-secondary">{{ producto.nombre }}</span>
                    {% empty %}
                        Sin productos
                    {% endfor %}
                </td>
                <td>
                    <a href="{% url 'actualizar_pedido' pedido.pk %}" class="btn btn-warning btn-sm me-2" title="Actualizar">
                        <i class="fas fa-edit"></i>
                    </a>
                    <a href="{% url 'borrar_pedido' pedido.pk %}" class="btn btn-danger btn-sm" title="Borrar">
                        <i class="fas fa-trash-alt"></i>
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="alert alert-info text-center" role="alert">
    <h4 class="alert-heading"><i class="fas fa-info-circle"></i> No hay pedidos registrados.</h4>
    <p>Â¡Comienza a gestionar tus pedidos!</p>
    <a href="{% url 'agregar_pedido' %}" class="btn btn-info mt-2"><i class="fas fa-cart-plus"></i> Realizar Pedido Ahora</a>
</div>
{% endif %}
{% endblock %}